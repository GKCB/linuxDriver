## 第 1 课 数码相框  (一共33节课时)

### 项目目录  

[第1节 数码相框之系统框架](#第1节_数码相框之系统框架)  
[第2-1节_数码相框_字符的编码方式](#第2-1节_数码相框_字符的编码方式)  


#### 第1节 数码相框之系统框架  

1. [弄清需求](#弄清需求)
2. [设计框架](#设计框架)
3. [编写代码](#编写代码)
4. 测试

#### 弄清需求    
如果是在一开始的时候，并不能确定需求到底该是怎样的可以先考虑这个产品是怎么操作的。以手机为例，先可以考虑一下具体的操作是如何实现的：  
1. 上电之后，LCD显示了一副图片    
2. 根据配置文件，决定停留还是自动显示下一副图片  
3. 点击一下，出现对话框：确定是```手动/自动``` 显示  
4. 根据上下左右判定图像是放大、缩小、下一幅、上一幅  
5. 左右移动过快，显示下下一副图片  

#### 设计框架    
大公司中的系统工程师，他们的主要责任，就是设计这款产品的框架。需要提供相关的文档，各个模块之间的接口是做啥的。  

以```数码相框```为例进行框架设计：  
1. 输入进程  
2. 显示进程  


1.输入进程  

为了得到触摸屏的数据，进程调用[tslib](https://baike.baidu.com/item/tslib/722869?fr=aladdin)来操作读取触摸屏的数据。  

这个```输入进程```也需要封装。需要封装的要素有：1. 事件 2. 时间 3. 类型 (点击、移动、位置) 4. 数据(位置、方向/速度/幅度)  
这些封装好了之后，需要使用```socket```发送给别的进程。  

2.显示进程  

里面需要多个线程，需要有负责接收```输入进程```的输出结果的。也需要处理进程要求的。    
使用库libjpeg来准备jpeg图片。  

考虑到有：```接收socket```、```主控```、```当前```、```左```、```右```、```上```、```下```。这7个功能，就要准备7个线程来处理它们。

总结：  
1. 输入进程需要包含：  
&emsp;主控线程:得到上报的事件，使用```socket```发出  
&emsp;触摸屏(ts)线程：使用tslib读触摸屏，封装事件并且上报  
&emsp;按键线程:读按键，封装事件上报  

2. 显示进程需要包含:    
&emsp;```socket```线程接收数据：接收```socket```信息。  
&emsp;放大线程：准备好当前图片的放大的数据    
&emsp;缩小线程：准备好当前图片的缩小的数据  
&emsp;上一幅线程：准备好上一幅要保留的图片  
&emsp;下一幅线程：准备好下一幅要保留的图片  
&emsp;当前图片线程：准备好当前图片  
&emsp;主控：根据```socket```线程准备好的信息(事件)，决定显示上下左右哪一幅图片  

线程之间可以实现资源的共享。  

3. 驱动程序：  
分配额外的5块内存，以及DMR、MMAP的操作。  

#### 编写代码  
编写代码也有两个方向可以考虑：1. 专家方向，某一类方向了解很深。2. 系统方向。    


返回 [第1节 数码相框之系统框架](#第1节数码相框之系统框架)

返回 [项目目录](#项目目录)  

#### 第2-1节_数码相框_字符的编码方式     


返回 [项目目录](#项目目录)  

